install.packages("forecast")
install.packages("TSA")
install.packages("teseries")
install.packages("Metrics")
library(forecast)
library(TSA)
library(tseries)
library(Metrics)

#¿¬±¸ÀÚ·á
X04041712<-ts(c(2126530,2313800,1968063,2152114,2246977,2255071,2278299,2201215,2340268,2456026,2431427,2347187,2533827,2696642,2539852,2657182,2912437,2705079,2965824,2880418,3243639,3207038,2825476,2658265,3005225,3130466,2839677,2969148,3141492,2810235,3403400,3138112,3361603,3223781,3084893,2975220,3029637,3242324,2971527,2964913,3161695,3019178,3176309,3181259,3284399,3136314,3138044,2995339,3064641,3430358,3014984,3024294,3337668,3153008,3298904,3264323,3158528,3276940,2834741,2952707,3073264,3347086,2939033,2997165,3342497,2858056,3495098,3083874,3276479,3323400,3208763,3114828,3182909,3538849,3040585,3279615,3496312,3310147,3670203,3923392,4259497,4112855,3991645,3841750,4176150,4383597,4008508,4110366,4325488,4141968,4520452,4323764,4372855,4330631,4082122,4153307,4251231,4543512,4286998,4265225,4337948,4143050,4637369,4534913,4795723,4406415,4394878,4423018,4441610,4855484,4396390,4366658,4612543,4496596,4791872,4866585,4692040,4466980,4326563,4478577,4588909,4958571,4591295,4567159,4995313,4752929,5119307,4915741,5155766,4804075,4528712,4675532,5116660,5739877,3738329,4803630,5342129,5203044,5633284,5511304,5438409,5215641,5184139,5011672,5356844,5692455,5270657,5416691,5424543,5399219,5911270,5656226,6086534,6456301,5882089,6104486,6552933,6864485,6338881,6466360,6686069,6569423,7185089,6963387,7476392), start = 2004+3/12, frequency = 12)
X11011712<-ts(c(4112855, 3991645, 3841750, 4176150, 4383597, 4008508, 4110366, 4325488, 4141968, 4520452, 4323764, 4372855, 4330631, 4082122, 4153307, 4251231, 4543512, 4286998, 4265225, 4337948, 4143050, 4637369, 4534913, 4795723, 4406415, 4394878, 4423018, 4441610, 4855484, 4396390, 4366658, 4612543, 4496596, 4791872, 4866585, 4692040, 4466980, 4326563, 4478577, 4588909, 4958571, 4591295, 4567159, 4995313, 4752929, 5119307, 4915741, 5155766, 4804075, 4528712, 4675532, 5116660, 5739877, 3738329, 4803630, 5342129, 5203044, 5633284, 5511304, 5438409, 5215641, 5184139, 5011672, 5356844, 5692455, 5270657, 5416691, 5424543, 5399219, 5911270, 5656226, 6086534, 6456301, 5882089, 6104486, 6552933, 6864485, 6338881, 6466360, 6686069, 6569423, 7185089, 6963387, 7476392), start = 2011, frequency = 12)
plot(X04041712, main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
ggseasonplot(X04041712, main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
plot(X11011712, main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')

#¼±ÇüÈ¸±Í
Z11011712<-c(4112855, 3991645, 3841750, 4176150, 4383597, 4008508, 4110366, 4325488, 4141968, 4520452, 4323764, 4372855, 4330631, 4082122, 4153307, 4251231, 4543512, 4286998, 4265225, 4337948, 4143050, 4637369, 4534913, 4795723, 4406415, 4394878, 4423018, 4441610, 4855484, 4396390, 4366658, 4612543, 4496596, 4791872, 4866585, 4692040, 4466980, 4326563, 4478577, 4588909, 4958571, 4591295, 4567159, 4995313, 4752929, 5119307, 4915741, 5155766, 4804075, 4528712, 4675532, 5116660, 5739877, 3738329, 4803630, 5342129, 5203044, 5633284, 5511304, 5438409, 5215641, 5184139, 5011672, 5356844, 5692455, 5270657, 5416691, 5424543, 5399219, 5911270, 5656226, 6086534, 6456301, 5882089, 6104486, 6552933, 6864485, 6338881, 6466360, 6686069, 6569423, 7185089, 6963387, 7476392)
Ztime<-c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84)
#´Ü¼ø ¼±Çü È¸±Í
lm11011712<-lm(Z11011712~Ztime)
lm11011712
summary(lm11011712)
anova(lm11011712)
#´ÙÇ× ¼±Çü È¸±Í
lm11011712_2<-lm(formula = Z11011712 ~ Ztime + I(Ztime^2))
lm11011712_2
summary(lm11011712_2)
anova(lm11011712_2)
#ºñ¼±Çü È¸±Í
unlm11011712<-lm(log(Z11011712)~Ztime)
unlm11011712
summary(unlm11011712)
anova(unlm11011712)
#ÀÜÂ÷ºÐ¼®
shapiro.test(Z11011712)
shapiro.test(residuals(lm11011712))
shapiro.test(residuals(lm11011712_2))
shapiro.test(residuals(unlm11011712))
plot(x=Ztime, y=Z11011712, main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(predict(lm11011712), col="red", main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
plot(x=Ztime, y=Z11011712, main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(predict(lm11011712_2), col="red", main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
plot(x=Ztime, y=Z11011712, main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(Ztime, exp(0.005826*Ztime+15.164384), col = "red", main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
par(mfrow=c(1,2))
plot(lm11011712, main = "")
plot(lm11011712_2, main = "")
plot(unlm11011712, main = "")
par(mfrow=c(1,1))
plot(x=Ztime, y=Z11011712, main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(predict(lm11011712), main = "",lty = 1, col = 2)
lines(predict(lm11011712_2), main = "",lty = 2, col = 4)
lines(Ztime, exp(0.005826*Ztime+15.164384), main = "",lty = 4, col = 6)
legend('topleft',legend = c('´Ü¼ø ¼±Çü È¸±Í','2Â÷ ´ÙÇ× ¼±Çü È¸±Í','ºñ¼±Çü È¸±Í'), lty = c(1,2,4), col =c(2,4,6) )

#°³ÀÔ Àü ¸ðÇü
X11011505<-ts(c(4112855, 3991645, 3841750, 4176150, 4383597, 4008508, 4110366, 4325488, 4141968, 4520452, 4323764, 4372855, 4330631, 4082122, 4153307, 4251231, 4543512, 4286998, 4265225, 4337948, 4143050, 4637369, 4534913, 4795723, 4406415, 4394878, 4423018, 4441610, 4855484, 4396390, 4366658, 4612543, 4496596, 4791872, 4866585, 4692040, 4466980, 4326563, 4478577, 4588909, 4958571, 4591295, 4567159, 4995313, 4752929, 5119307, 4915741, 5155766, 4804075, 4528712, 4675532, 5116660, 5739877), start = 2011, frequency = 12)
plot(X11011505, main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
par(mfrow=c(1,2))
plot(X11011505, main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(ma(X11011505, 5), col="red", main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
plot(X11011505, main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(ma(X11011505, 12), col="red", main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
par(mfrow=c(1,1))
#Á¤»ó¼º
par(mfrow=c(1,2))
Acf(X11011505, main = "")
Pacf(X11011505, main = "")
Acf(diff(X11011505, lag = 1), main = "")
Pacf(diff(X11011505, lag = 1), main = "")
Acf(diff(X11011505, lag = 2), main = "")
Pacf(diff(X11011505, lag = 2), main = "")
Acf(diff(X11011505, lag = 12), main = "")
Pacf(diff(X11011505, lag = 12), main = "")
Acf(sqrt(X11011505), main = "")
Pacf(sqrt(X11011505), main = "")
par(mfrow=c(1,1))
adf.test(X11011505,k=0)
adf.test(diff(X11011505,lag=1),k=0)
adf.test(diff(X11011505,lag=2),k=0)
adf.test(diff(X11011505,lag=12),k=0)
adf.test(sqrt(X11011505),k=0)
#¸ðÇü ½Äº°
X11011505 %>% sqrt() %>% diff(lag=12) %>% diff(lag=1) %>% ggtsdisplay(main = "")
AIC(arima(sqrt(X11011505), order = c(0,1,0), seasonal = list(order = c(0,1,0), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(0,1,0), seasonal = list(order = c(0,1,0), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(0,1,0), seasonal = list(order = c(0,1,1), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(0,1,0), seasonal = list(order = c(0,1,1), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(0,1,0), seasonal = list(order = c(1,1,0), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(0,1,0), seasonal = list(order = c(1,1,0), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(0,1,0), seasonal = list(order = c(1,1,1), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(0,1,0), seasonal = list(order = c(1,1,1), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(0,1,0), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(0,1,0), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(1,1,1), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(1,1,1), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(1,1,0), seasonal = list(order = c(0,1,0), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(1,1,0), seasonal = list(order = c(0,1,0), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(1,1,0), seasonal = list(order = c(0,1,1), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(1,1,0), seasonal = list(order = c(0,1,1), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(1,1,0), seasonal = list(order = c(1,1,0), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(1,1,0), seasonal = list(order = c(1,1,0), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(1,1,0), seasonal = list(order = c(1,1,1), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(1,1,0), seasonal = list(order = c(1,1,1), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(0,1,0), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(0,1,0), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))
AIC(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(1,1,1), frequency = 12)))
BIC(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(1,1,1), frequency = 12)))
par(mfrow=c(1,2))
Acf(X11011505 - (fitted(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(0,1,1), frequency = 12))))^2, main = "")
Pacf(X11011505 - (fitted(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(0,1,1), frequency = 12))))^2, main = "")
Acf(X11011505 - (fitted(arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))^2), main = "")
Pacf(X11011505 - (fitted(arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))^2), main = "")
Acf(X11011505 - (fitted(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))^2), main = "")
Pacf(X11011505 - (fitted(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))^2), main = "")
Acf(X11011505 - (fitted(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))^2), main = "")
Pacf(X11011505 - (fitted(arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))^2), main = "")
par(mfrow=c(1,1))
X11011505_arima<-arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12))
X11011505_arima
#¸ðÇü °ËÁõ
#Æ÷Æ®¸ÇÅä °ËÁ¤
checkresiduals(X11011505_arima, main = "")
#°ú´ëÀûÇÕ
arima(sqrt(X11011505), order = c(1,1,1), seasonal = list(order = c(0,1,1), frequency = 12))
arima(sqrt(X11011505), order = c(0,1,2), seasonal = list(order = c(0,1,1), frequency = 12))
arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(1,1,1), frequency = 12))
arima(sqrt(X11011505), order = c(0,1,1), seasonal = list(order = c(0,1,2), frequency = 12))

#°³ÀÔ ¸ðÇü
#¸ðÇü ½Äº°
arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12))
arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0)))
arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0)))
arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0)))
-391.11*(-2)+4
-360.98*(-2)+4
-382.31*(-2)+4
-372.84*(-2)+4
-391.11*(-2)+2*log(84)
-360.98*(-2)+2*log(84)
-382.31*(-2)+2*log(84)
-372.84*(-2)+2*log(84)
forecast((fitted(arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12))))^2, h=12)
forecast((fitted(arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0)))))^2, h=12)
forecast((fitted(arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0)))))^2, h=12)
forecast((fitted(arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0)))))^2, h=12)
p<-c(7106811,7324957,7044748,7282586,7825580,7225023,7216686,7456749,7532946,7865217,7965751,7881336)
f_1<-c(6908126,6717615,6697830,7089282,7588417,6948037,7069100,7433045,7189147,7853298,7675953,7828640)
f_2<-c(6917844,6884571,6910330,7207113,7621132,7111299,7343178,7608998,7472220,7949867,7866666,8003786)
f_3<-c(6866901,6657643,6616039,6955955,7408758,6730136,6865383,7195944,6918609,7513712,7310052,7503349)
f_4<-c(6965138,6941430,6861528,7464106,8043963,7212114,7529802,8009470,7799397,8510507,8473847,8723894)
rmse(p,f_1)
mae(p,f_1)
mape(p,f_1)
rmse(p,f_2)
mae(p,f_2)
mape(p,f_2)
rmse(p,f_3)
mae(p,f_3)
mape(p,f_3)
rmse(p,f_4)
mae(p,f_4)
mape(p,f_4)
(fitted(arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12))))^2
(fitted(arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0)))))^2
(fitted(arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0)))))^2
(fitted(arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0)))))^2
model_1<-ts(c(4108107, 3989646, 3840592, 4174949, 4382425, 4007913, 4109755, 4324735, 4141485, 4519630, 4323219, 4377069, 4359708, 4156161, 4040426, 4354795, 4550454, 4202507, 4301081, 4464224, 4228762, 4612054, 4450661, 4592351, 4514533, 4313979, 4317176, 4544702, 4793398, 4463447, 4467654, 4596874, 4422037, 4871898, 4729776, 4877117, 4597522, 4411951, 4384067, 4570660, 4897991, 4545555, 4575063, 4788720, 4681849, 5111782, 5017378, 5053660, 4856577, 4682184, 4662091, 4847634, 5314384, 4897154, 4575502, 4935269, 4894943, 5419165, 5381301, 5510886, 5227552, 5063050, 5139431, 5320088, 5735848, 5002686, 5334450, 5661463, 5396842, 5833550, 5729968, 5801330, 5693074, 5783164, 5850150, 6214369, 6760084, 6059250, 6400500, 6715551, 6529577, 7039982, 6931336, 7110681, 6908126, 6717615, 6697830, 7089282, 7588417, 6948037, 7069100, 7433045, 7189147, 7853298, 7675953, 7828640), start = 2011, frequency = 12)
model_2<-ts(c(4108107, 3989646, 3840592, 4174949, 4382425, 4007913, 4109755, 4324735, 4141485, 4519630, 4323219, 4377069, 4359708, 4170689, 4016357, 4382405, 4539060, 4186385, 4318531, 4477396, 4213578, 4579882, 4433170, 4583136, 4573010, 4302374, 4321560, 4579792, 4779153, 4479923, 4467597, 4568678, 4405554, 4892361, 4707483, 4921553, 4578118, 4386905, 4348258, 4566550, 4900128, 4553383, 4586969, 4775318, 4719129, 5142648, 5049834, 5027319, 4864283, 4689880, 4640236, 4810296, 5332033, 3845871, 5041475, 5216497, 5087916, 5562665, 5484190, 5597354, 5238177, 5049252, 5186068, 5321019, 5769863, 5240787, 5213900, 5660548, 5346242, 5801407, 5737884, 5758964, 5676487, 5936947, 5920052, 6301208, 6883417, 6354494, 6346637, 6697549, 6527636, 7042569, 6950807, 7124481, 6917844, 6884571, 6910330, 7207113, 7621132, 7111299, 7343178, 7608998, 7472220, 7949867, 7866666, 8003786), start = 2011, frequency = 12)
model_3<-ts(c(4108107, 3989646, 3840592, 4174949, 4382425, 4007913, 4109755, 4324735, 4141485, 4519630, 4323219, 4377069, 4359708, 4149061, 4051821, 4341509, 4558121, 4210898, 4290337, 4463778, 4258124, 4660081, 4484618, 4596694, 4465512, 4299675, 4286943, 4494215, 4772387, 4432779, 4458711, 4613709, 4430957, 4863110, 4738130, 4855688, 4630405, 4476556, 4461083, 4615002, 4933692, 4560087, 4576247, 4785655, 4624165, 5036204, 4951212, 5014752, 4801577, 4652619, 4677049, 4848551, 5230487, 4758147, 4762370, 5038374, 4871842, 5303051, 5213259, 5321548, 5083668, 4931574, 4992631, 5217901, 5632889, 4899744, 5171144, 5495913, 5310126, 5745947, 5631281, 6145604, 6158997, 6138304, 6218810, 6528407, 6990213, 6226715, 6495538, 6792519, 6611625, 7104558, 6949223, 7024551, 6866901, 6657643, 6616039, 6955955, 7408758, 6730136, 6865383, 7195944, 6918609, 7513712, 7310052, 7503349), start = 2011, frequency = 12)
model_4<-ts(c(4108107, 3989646, 3840592, 4174949, 4382425, 4007913, 4109755, 4324735, 4141485, 4519630, 4323219, 4377069, 4359707, 4206166, 3933179, 4495670, 4465833, 4159929, 4389498, 4486981, 4157261, 4521937, 4435721, 4583100, 4746741, 4165722, 4457957, 4531046, 4740135, 4584552, 4381465, 4444166, 4408220, 5006007, 4689775, 5127292, 4324037, 4446357, 4358016, 4496860, 5004419, 4500132, 4559224, 4814097, 4868567, 5064317, 5190681, 4756644, 4907245, 4663696, 4684011, 4786176, 5500366, 3961800, 4862280, 5413234, 5119159, 5586036, 5426127, 5752739, 5086278, 4929224, 5335672, 5466629, 5990693, 5044591, 5185776, 5801120, 5266427, 5829820, 5781976, 5599780, 5842067, 6404971, 5720527, 6481296, 6931701, 6396803, 6494990, 6486345, 6650316, 7133135, 6906267, 7417260, 6965138, 6941430, 6861528, 7464106, 8043963, 7212114, 7529802, 8009470, 7799397, 8510507, 8473847, 8723894), start = 2011, frequency = 12)
X11011812<-ts(c(4112855, 3991645, 3841750, 4176150, 4383597, 4008508, 4110366, 4325488, 4141968, 4520452, 4323764, 4372855, 4330631, 4082122, 4153307, 4251231, 4543512, 4286998, 4265225, 4337948, 4143050, 4637369, 4534913, 4795723, 4406415, 4394878, 4423018, 4441610, 4855484, 4396390, 4366658, 4612543, 4496596, 4791872, 4866585, 4692040, 4466980, 4326563, 4478577, 4588909, 4958571, 4591295, 4567159, 4995313, 4752929, 5119307, 4915741, 5155766, 4804075, 4528712, 4675532, 5116660, 5739877, 3738329, 4803630, 5342129, 5203044, 5633284, 5511304, 5438409, 5215641, 5184139, 5011672, 5356844, 5692455, 5270657, 5416691, 5424543, 5399219, 5911270, 5656226, 6086534, 6456301, 5882089, 6104486, 6552933, 6864485, 6338881, 6466360, 6686069, 6569423, 7185089, 6963387, 7476392,7106811,7324957,7044748,7282586,7825580,7225023,7216686,7456749,7532946,7865217,7965751,7881336), start = 2011, frequency = 12)
par(mfrow=c(2,2))
plot(X11011812, col = 1, lwd = 1 , main = "¸ðÇü 1", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(model_1, col = 2, lwd = 1, ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
legend('topleft',legend = c('½ÇÁ¦°ª','¸ðÇü1'), col = c(1,2), lty = c(1,1))
plot(X11011812, col = 1, lwd = 1 , main = "¸ðÇü 2", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(model_2, col = 2, lwd = 1, ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
legend('topleft',legend = c('½ÇÁ¦°ª','¸ðÇü2'), col = c(1,2), lty = c(1,1))
plot(X11011812, col = 1, lwd = 1 , main = "¸ðÇü 3", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(model_3, col = 2, lwd = 1, ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
legend('topleft',legend = c('½ÇÁ¦°ª','¸ðÇü3'), col = c(1,2), lty = c(1,1))
plot(X11011812, col = 1, lwd = 1 , main = "¸ðÇü 4", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(model_4, col = 2, lwd = 1, ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
legend('topleft',legend = c('½ÇÁ¦°ª','¸ðÇü4'), col = c(1,2), lty = c(1,1))
par(mfrow=c(1,1))
par(mfrow=c(1,2))
Acf(X11011712 - (fitted(arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12))))^2, main = "")
Pacf(X11011712 - (fitted(arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12))))^2, main = "")
Acf(X11011712 - (fitted(arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0)))))^2, main = "")
Pacf(X11011712 - (fitted(arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0)))))^2, main = "")
Acf(X11011712 - (fitted(arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0)))))^2, main = "")
Pacf(X11011712 - (fitted(arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0)))))^2, main = "")
Acf(X11011712 - (fitted(arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0)))))^2, main = "")
Pacf(X11011712 - (fitted(arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0)))))^2, main = "")
par(mfrow=c(1,1))
#¸ðÇü ÃßÁ¤
X11011712_arimax<-arimax(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0)))
X11011712_arimax
#¸ðÇü °ËÁõ
checkresiduals(X11011712_arimax, main = "")
plot((fitted(X11011712_arimax))^2,col="red", main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(X11011712, main = "")
legend('topleft',legend = c('½ÇÁ¦°ª','°³ÀÔ °èÀýÇü ARIMA ¸ðÇü'), col = c(1,2), lty = c(1,1))

#¿¹Ãø
X11011712_fcast<-forecast((fitted(X11011712_arimax))^2, h=12)
X11011712_fcast
plot(X11011712_fcast, main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
X11011812<-ts(c(4112855, 3991645, 3841750, 4176150, 4383597, 4008508, 4110366, 4325488, 4141968, 4520452, 4323764, 4372855, 4330631, 4082122, 4153307, 4251231, 4543512, 4286998, 4265225, 4337948, 4143050, 4637369, 4534913, 4795723, 4406415, 4394878, 4423018, 4441610, 4855484, 4396390, 4366658, 4612543, 4496596, 4791872, 4866585, 4692040, 4466980, 4326563, 4478577, 4588909, 4958571, 4591295, 4567159, 4995313, 4752929, 5119307, 4915741, 5155766, 4804075, 4528712, 4675532, 5116660, 5739877, 3738329, 4803630, 5342129, 5203044, 5633284, 5511304, 5438409, 5215641, 5184139, 5011672, 5356844, 5692455, 5270657, 5416691, 5424543, 5399219, 5911270, 5656226, 6086534, 6456301, 5882089, 6104486, 6552933, 6864485, 6338881, 6466360, 6686069, 6569423, 7185089, 6963387, 7476392,7106811,7324957,7044748,7282586,7825580,7225023,7216686,7456749,7532946,7865217,7965751,7881336), start = 2011, frequency = 12)
plot(X11011712_fcast, col='white', main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö', lwd = 1)
lines(X11011812, col=1, main = "", lwd = 1)
legend('topleft',legend = c('½ÇÁ¦°ª','°³ÀÔ °èÀýÇü ARIMA ¸ðÇü'), col = c(1,4), lty = c(1,1), lwd = c(1,1))


#ÈÄ¼Ó¿¬±¸
X11011812_arimax<-arimax(sqrt(X11011812), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011812)==54)), transfer = list(c(1,0)))
X11011812_arimax
X11011812_fcast<-forecast((fitted(X11011812_arimax))^2, h=12)
X11011812_fcast
plot(X11011812_fcast, main = "", ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')

#ºÎ·Ï1
AIC(arima(X11011505, order = c(0,1,0), seasonal = list(order = c(0,1,0), frequency = 12)))
BIC(arima(X11011505, order = c(0,1,0), seasonal = list(order = c(0,1,0), frequency = 12)))
AIC(arima(X11011505, order = c(0,1,0), seasonal = list(order = c(0,1,1), frequency = 12)))
BIC(arima(X11011505, order = c(0,1,0), seasonal = list(order = c(0,1,1), frequency = 12)))
AIC(arima(X11011505, order = c(0,1,0), seasonal = list(order = c(1,1,0), frequency = 12)))
BIC(arima(X11011505, order = c(0,1,0), seasonal = list(order = c(1,1,0), frequency = 12)))
AIC(arima(X11011505, order = c(0,1,0), seasonal = list(order = c(1,1,1), frequency = 12)))
BIC(arima(X11011505, order = c(0,1,0), seasonal = list(order = c(1,1,1), frequency = 12)))
AIC(arima(X11011505, order = c(0,1,1), seasonal = list(order = c(0,1,0), frequency = 12)))
BIC(arima(X11011505, order = c(0,1,1), seasonal = list(order = c(0,1,0), frequency = 12)))
AIC(arima(X11011505, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))
BIC(arima(X11011505, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))
AIC(arima(X11011505, order = c(0,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))
BIC(arima(X11011505, order = c(0,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))
AIC(arima(X11011505, order = c(0,1,1), seasonal = list(order = c(1,1,1), frequency = 12)))
BIC(arima(X11011505, order = c(0,1,1), seasonal = list(order = c(1,1,1), frequency = 12)))
AIC(arima(X11011505, order = c(1,1,0), seasonal = list(order = c(0,1,0), frequency = 12)))
BIC(arima(X11011505, order = c(1,1,0), seasonal = list(order = c(0,1,0), frequency = 12)))
AIC(arima(X11011505, order = c(1,1,0), seasonal = list(order = c(0,1,1), frequency = 12)))
BIC(arima(X11011505, order = c(1,1,0), seasonal = list(order = c(0,1,1), frequency = 12)))
AIC(arima(X11011505, order = c(1,1,0), seasonal = list(order = c(1,1,0), frequency = 12)))
BIC(arima(X11011505, order = c(1,1,0), seasonal = list(order = c(1,1,0), frequency = 12)))
AIC(arima(X11011505, order = c(1,1,0), seasonal = list(order = c(1,1,1), frequency = 12)))
BIC(arima(X11011505, order = c(1,1,0), seasonal = list(order = c(1,1,1), frequency = 12)))
AIC(arima(X11011505, order = c(1,1,1), seasonal = list(order = c(0,1,0), frequency = 12)))
BIC(arima(X11011505, order = c(1,1,1), seasonal = list(order = c(0,1,0), frequency = 12)))
AIC(arima(X11011505, order = c(1,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))
BIC(arima(X11011505, order = c(1,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))
AIC(arima(X11011505, order = c(1,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))
BIC(arima(X11011505, order = c(1,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))
AIC(arima(X11011505, order = c(1,1,1), seasonal = list(order = c(1,1,1), frequency = 12)))
BIC(arima(X11011505, order = c(1,1,1), seasonal = list(order = c(1,1,1), frequency = 12)))
arima(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12))
arimax(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0)))
arimax(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0)))
arimax(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0)))
-988.09*(-2)+4
-969.98*(-2)+4
-991.19*(-2)+4
-969.96*(-2)+4
-988.09*(-2)+2*log(84)
-969.98*(-2)+2*log(84)
-991.19*(-2)+2*log(84)
-969.96*(-2)+2*log(84)
forecast((fitted(arima(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))), h=12)
forecast((fitted(arimax(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0))))), h=12)
forecast((fitted(arimax(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0))))), h=12)
forecast((fitted(arimax(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0))))), h=12)
p<-c(7106811,7324957,7044748,7282586,7825580,7225023,7216686,7456749,7532946,7865217,7965751,7881336)
ff_1<-c(6875355,6703947,6664124,7042265,7523633,6932805,7021037,7365159,7146575,7786170,7616481,7760313)
ff_2<-c(6998398,6944450,6827553,7387234,8011111,7220076,7483820,7924543,7673967,8467033,8324192,8521406)
ff_3<-c(6971158,6885488,6876390,7362582,7930671,7275321,7473603,7851950,7653027,8435813,8194953,8469247)
ff_4<-c(7029199,6945472,6881693,7389648,8006034,7224975,7507457,7959844,7755958,8477066,8350357,8566452)
rmse(p,ff_1)
mae(p,ff_1)
mape(p,ff_1)
rmse(p,ff_2)
mae(p,ff_2)
mape(p,ff_2)
rmse(p,ff_3)
mae(p,ff_3)
mape(p,ff_3)
rmse(p,ff_4)
mae(p,ff_4)
mape(p,ff_4)
par(mfrow=c(1,2))
Acf(X11011712 - (fitted(arima(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))), main = "")
Pacf(X11011712 - (fitted(arima(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))), main = "")
Acf(X11011712 - (fitted(arimax(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0))))), main = "")
Pacf(X11011712 - (fitted(arimax(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0))))), main = "")
Acf(X11011712 - (fitted(arimax(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0))))), main = "")
Pacf(X11011712 - (fitted(arimax(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0))))), main = "")
Acf(X11011712 - (fitted(arimax(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0))))), main = "")
Pacf(X11011712 - (fitted(arimax(X11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0))))), main = "")
par(mfrow=c(1,1))

#ºÎ·Ï2
KTX11011712<-ts(c(4112855, 3991645, 3841750, 4176150, 4383597, 4008508, 4110366, 4325488, 4141968, 4520452, 4323764, 4372855, 4330631, 4082122, 4153307, 4251231, 4543512, 4286998, 4265225, 4337948, 4143050, 4637369, 4534913, 4795723, 4406415, 4394878, 4423018, 4441610, 4855484, 4396390, 4366658, 4612543, 4496596, 4791872, 4866585, 4692040, 4466980, 4326563, 4478577, 4588909, 4958571, 4591295, 4567159, 4995313, 4752929, 5119307, 4915741, 5155766, 4804075, 4528712, 4675532, 5116660, 5739877, 3738329, 4803630, 5342129, 5203044, 5633284, 5511304, 5438409, 5215641, 5184139, 5011672, 5356844, 5692455, 5270657, 5416691, 5424543, 5399219, 5911270, 5656226, 5077771, 4980250, 4499050, 4650458, 5008049, 5216446, 4759113, 4721211, 4978511, 4883171, 5377839, 5180022, 5576847), start = 2011, frequency = 12)
plot(KTX11011712, main='', ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
arima(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12))
arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0)))
arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0)))
arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0)))
plot(KTX11011712, main='', ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(fitted(arima(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12))),col='red')
plot(KTX11011712, main='', ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(fitted(arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0)))),col='red')
plot(KTX11011712, main='', ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(fitted(arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0)))),col='red')
plot(KTX11011712, main='', ylab = '°í¼ÓÃ¶µµ ÀÌ¿ë°´ ¼ö')
lines(fitted(arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0)))),col='red')
forecast((fitted(arima(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))), h=12)
forecast((fitted(arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0))))), h=12)
forecast((fitted(arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0))))), h=12)
forecast((fitted(arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0))))), h=12)
ktxp<-c(5312770,5620954,5222578,5429237,5874116,5368182,5323433,5535961,5640411,5877544,5970811,5865197)
ktxf_1<-c(4990740,4789582,4720836,4942174,5261302,4794550,4848799,5067699,4887435,5314804,5183972,5253870)
ktxf_2<-c(4980923,4980923,4980923,4980923,4980923,4980923,4980923,4980923,4980923,4980923,4980923,4980923)
ktxf_3<-c(4906387,4707734,4640976,4890335,5236836,4711618,4813414,5044564,4869275,5280008,5136569,5142390)
ktxf_4<-c(4991180,4991180,4991180,4991180,4991180,4991180,4991180,4991180,4991180,4991180,4991180,4991180)
rmse(ktxp,ktxf_1)
mae(ktxp,ktxf_1)
mape(ktxp,ktxf_1)
rmse(ktxp,ktxf_2)
mae(ktxp,ktxf_2)
mape(ktxp,ktxf_2)
rmse(ktxp,ktxf_3)
mae(ktxp,ktxf_3)
mape(ktxp,ktxf_3)
rmse(ktxp,ktxf_4)
mae(ktxp,ktxf_4)
mape(ktxp,ktxf_4)
par(mfrow=c(1,2))
Acf(X11011712 - (fitted(arima(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))), main = "")
Pacf(X11011712 - (fitted(arima(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))), main = "")
Acf(X11011712 - (fitted(arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0))))), main = "")
Pacf(X11011712 - (fitted(arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54)), transfer = list(c(1,0))))), main = "")
Acf(X11011712 - (fitted(arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0))))), main = "")
Pacf(X11011712 - (fitted(arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0))))), main = "")
Acf(X11011712 - (fitted(arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0))))), main = "")
Pacf(X11011712 - (fitted(arimax(KTX11011712, order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12), xtransf = data.frame(Jun15=1*(seq(X11011712)==54), Dec16=1*(seq(X11011712)>=72)), transfer = list(c(1,0),c(1,0))))), main = "")
par(mfrow=c(1,1))

#ºÎ·Ï3
holiday<-c(0,1,1,0,1,1,0,1,1,1,0,0,1,0,1,1,1,1,0,1,0,1,0,1,1,1,1,0,1,1,0,1,1,1,0,1,1,0,1,0,1,1,0,1,1,1,0,1,1,1,0,0,1,0,0,0,1,1,0,1,1,1,1,1,1,1,0,1,1,1,0,0,1,0,1,0,1,1,0,1,0,1,0,1)
pongdang<-c(0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,1,0,1,0,1,1,0,0,0,0,1,0,1,0,1,0,1,1,0,0,0,0,1,0,0,0,1,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,1,0,0,0,1)
straight<-c(0,1,0,0,0,1,0,1,1,1,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1,1,0,1,0,0,0,1,0,0,0,1,0,1,0,1,1,0,1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,0,1,1,1,0,0,1,1,0,1,1,1,0,0,1,0,0,0,1,0,0,0,0,1,0,1)
glm11011712<-lm(Z11011712 ~ Ztime + holiday)
summary(glm11011712)
anova(glm11011712)
glm11011712_2<-lm(Z11011712 ~ Ztime + holiday + pongdang + straight)
summary(glm11011712_2)
anova(glm11011712_2)

#¼öÁ¤
X11011712 %>% sqrt() %>% diff(lag=12) %>% diff(lag=1) %>% ggtsdisplay(main = "")
X11011712_arima<-arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12))
X11011712_arima
checkresiduals(X11011712_arima, main = "")
AIC(arima(sqrt(X11011712), order = c(0,1,0), seasonal = list(order = c(0,1,0), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(0,1,0), seasonal = list(order = c(0,1,0), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(0,1,0), seasonal = list(order = c(0,1,1), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(0,1,0), seasonal = list(order = c(0,1,1), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(0,1,0), seasonal = list(order = c(1,1,0), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(0,1,0), seasonal = list(order = c(1,1,0), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(0,1,0), seasonal = list(order = c(1,1,1), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(0,1,0), seasonal = list(order = c(1,1,1), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,0), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,0), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(1,1,1), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(0,1,1), seasonal = list(order = c(1,1,1), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(1,1,0), seasonal = list(order = c(0,1,0), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(1,1,0), seasonal = list(order = c(0,1,0), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(1,1,0), seasonal = list(order = c(0,1,1), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(1,1,0), seasonal = list(order = c(0,1,1), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(1,1,0), seasonal = list(order = c(1,1,0), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(1,1,0), seasonal = list(order = c(1,1,0), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(1,1,0), seasonal = list(order = c(1,1,1), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(1,1,0), seasonal = list(order = c(1,1,1), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(1,1,1), seasonal = list(order = c(0,1,0), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(1,1,1), seasonal = list(order = c(0,1,0), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(1,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(1,1,1), seasonal = list(order = c(0,1,1), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(1,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(1,1,1), seasonal = list(order = c(1,1,0), frequency = 12)))
AIC(arima(sqrt(X11011712), order = c(1,1,1), seasonal = list(order = c(1,1,1), frequency = 12)))
BIC(arima(sqrt(X11011712), order = c(1,1,1), seasonal = list(order = c(1,1,1), frequency = 12)))
